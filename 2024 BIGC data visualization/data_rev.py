#!/usr/bin/env python
# coding: utf-8

# In[1]:


import geopandas as gpd

df = gpd.read_file('data/seoul.geojson', encoding='UTF-8')
df
#adm_nm,adm_cd2,geometry 


# In[2]:


df=df[['adm_nm','adm_cd2','geometry']]
df.head()


# In[3]:


def polygon_to_coordinates(x):
    lon, lat = x.exterior.xy
    return [[x, y] for x, y in zip(lon, lat)]

df['coordinates'] = df['geometry'].apply(polygon_to_coordinates)
del df['geometry']


# In[4]:


import pandas as pd
df=pd.DataFrame(df)


# In[5]:


import numpy as np
arr=df.to_numpy()


# In[6]:


# 일원2동 -> 개포3동
# 1168074000 -> 1168067500
g1=arr[arr[:,1]=='1168074000'][0,2]
arr[arr[:,1]=='1168074000']=np.array([['서울특별시 강남구 개포3동', '1168067500',g1]],dtype=object)

# 강일동 -> 강일동
# 1174051500 -> 1174051500
g2=[[127.162785,37.576884],[127.173451,37.563940],[127.170746,37.562079],[127.171503,37.557595],[127.181803,37.559160],[127.179185,37.569263],[127.175408,37.578379],[127.176996,37.579603],[127.176996,37.581202],[127.172705,37.579501],[127.166782,37.579025],[127.163864,37.577495]]
arr[arr[:,1]=='1174051500']=np.array([['서울특별시 강동구 강일동', '1174051500',g2]],dtype=object)

# 상일동 -> 상일1동
# 1174052000 -> 1174052500
g3=arr[arr[:,1]=='1174052000'][0,2]
arr[arr[:,1]=='1174052000']=np.array([['서울특별시 강동구 상일제1동', '1174052500',g3]],dtype=object)

#고덕2동 -> 고덕2동 (좌표오류)
g4=[[127.153369,37.573056],[127.153382,37.567032], [127.154354466487, 37.56804528430635],[127.15472253951764, 37.56818607092829],[127.15531547219828, 37.56821822419583],[127.15543929112697, 37.568170408372204],[127.1559351324808, 37.56797892008248],[127.15636333636587, 37.56735823429568],[127.156927030999, 37.562962401950294],[127.15684010927747, 37.56062088395521],[127.1568381884844, 37.56057581161341],[127.15673710899863, 37.55854521933108],[127.15660557426494, 37.55590612384161],[127.15657896479796, 37.55537537070118],[127.156568,37.555531],[127.171278,37.557312],[127.170952,37.562118],[127.173154,37.563806],[127.162148,37.576448]]
arr[arr[:,1]=='1174056000']=np.array([['서울특별시 강동구 고덕2동', '1174056000',g4]],dtype=object)

# 강일동 -> 상일2동 (신설)
# 1174051500 -> 1174052600
g5=[[127.171569, 37.557149],[127.174173,37.545555],[127.174289,37.545280],[127.175673,37.545229],[127.175982,37.545612],[127.176639,37.545348],[127.176778,37.545748],[127.180362,37.546582],[127.183580,37.545246],[127.182904,37.551770],[127.181295,37.552970],[127.18176,37.558769],[127.176208,37.557515]]
new=np.array(['서울특별시 강동구 상일제2동', '1174052600',g5],dtype=object)
arr1=np.empty((426,3),dtype=object)
arr1[0:425,:]=arr
arr1[425,:]=new


# In[7]:


df1=pd.DataFrame(arr1)
df1.columns=['name','code','coordinates']
df_revised=df1.sort_values(by=["code"], ascending=[True]) 
df_revised.reset_index(inplace=True,drop=True)


# In[8]:


df_revised.head()


# In[ ]:




